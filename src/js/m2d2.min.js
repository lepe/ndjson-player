"use strict";class Utils{static htmlNode(t){const e=Utils.newNode("template");return e.innerHTML=t.trim(),e.content.firstChild}static newNode(t){return document.createElement(t)}static node(t,e){return void 0===e&&(e=document),t instanceof Node?t:e.querySelector(t)}static isNumeric(t){return!isNaN(parseFloat(t))&&isFinite(t)}static isSelectorID(t){return 0===(t+"").trim().indexOf("#")}static isPlainObject(t){return Utils.isObject(t)&&!Utils.isArray(t)}static isObject(t){return"object"==typeof t}static isArray(t){return Array.isArray(t)}static isFunction(t){return"function"==typeof t}static isHtml(t){return-1!==(t+"").trim().indexOf("<")}static isEmpty(t){return void 0===t||Utils.isObject(t)&&0===Object.keys(t).length||""===t}}
"use strict";class M2D2{root;constructor(e){this.root=e.root||"body",this.template=e.template||{},this.data=e.data||[],this._init()}static _ext={};static extend(e){Object.assign(M2D2._ext,e)}update(e,t,i){const o=this;if(o._rendered){const n=function(e){let n;if(void 0!==e._node)if(Utils.isArray(e))if(void 0===i)void 0!==e[t]._node&&e[t]._node.remove();else{let t;const i=[];for(t in e._node.childNodes)n=e._node.childNodes[t],void 0!==n.tagName&&"TEMPLATE"!==n.tagName&&i.push(n);for(t in i)n=i[t],n.remove();o._doRender(e._node,e)}else{const n={};n[t]=i.value,o._doRender(e._node,Object.assign(e,n))}};void 0===t&&Utils.isFunction(o._func)?o._doFunc(o._func,e,(function(e){n(e)})):n(e)}}get(){return this._defineProp(this._data,"m2d2",this),this._setProxy(),this._data}clear(){const e=this;e._rendered&&(e.$root.innerHTML=e._cache)}$root=null;_rendered=!1;_updater=!0;_cache=null;_data=null;_func=null;_htmlGenTags=["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","datalist","dd","del","details","dfn","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","map","mark","menu","meter","nav","ol","optgroup","option","output","p","pre","progress","q","rp","rt","ruby","samp","section","select","small","span","strong","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","tr","tt","ul","var"];_init(){const e=this;if(Utils.isFunction(e._data)){e._func=e._data;let t=e._doFunc(e._func,e.param);t&&(Utils.isArray(t)&&(t={items:t}),e._data=t,e._onReady())}else Utils.isObject(e._data)||(e._data={text:e._data}),e._onReady()}_render(){const e=this;if(void 0===e._data)return console.log("data is missing in m2d2 object with root: "+e.root),!1;e._doRender(e.$root,e._data),e._rendered=!0}_onReady(){const e=this;e.$root=Utils.node(e.root),e.$root?(e._cache=e.$root.innerHTML,e._render()):console.log("Warning: Node was not found: "+e.root)}_doFunc(e,t,i){const o=this;let n=e((function(e,t,n){let s;if(void 0!==n&&Utils.isNumeric(n)?s=n:void 0!==t&&Utils.isNumeric(t)&&(s=t),Utils.isArray(e)){const i={};void 0===t||Utils.isNumeric(t)?void 0!==o.template&&(i.template=o.template):i.template=t,i.items=e,e=i}if(Utils.isPlainObject(e)){o._updater=!1;let t=1;for(let i in e)t++===Object.keys(e).length&&(o._updater=!0),o._data[i]=e[i]}void 0===s&&o.interval>0&&(s=o.interval),s>0&&(o.interval=setInterval((function(){o._func((function(e){o._doRender(o.$root,e)}))}),s)),void 0!==i&&i(e)}),t)||{};return Utils.isArray(n)&&(n={items:n}),Utils.isObject(n)||console.log("Undefined type of 'data'. For automatic detection do not set any 'return' in the data's function. Or explicitly return '[]' for arrays or '{}' for objects."),n}_setProxy(){const e=this;void 0===e._data._proxy&&(Utils.isPlainObject(e._data)||Utils.isArray(e._data))&&(e._data=e._proxy(e._data,(function(t,i,o){"m2d2"!==i&&"_"!==i[0]&&e._updater&&e.update(t,i,o)})))}_doRender(e,t){t&&void 0!==t.oninit&&Utils.isFunction(t.oninit)&&(t.oninit(),delete t.oninit),Utils.isArray(t)&&(t={items:t}),this._setProxy(),this._setValues(e,t),t&&void 0!==t.onrender&&Utils.isFunction(t.onrender)&&(t.onrender(),delete t.onrender)}_doArray(e,t,i){const o=this;o._setNode(e,i);let n=o._getTemplate(e,t);for(let s=0;s<(i.length||Object.keys(i).length);s++){let l=i[s]||Object.values(i)[s];if(void 0!==l._node&&(l._node=void 0),!n)if(Utils.isPlainObject(l)){if(1!==Object.keys(l).length)return console.log("Warning: Multiple keys in data without template is not supported yet. Object:"),void console.log(t);if(Utils.isSelectorID(l)){const e=document.querySelector(l);if(!e)return console.log("Warning: ID selector for template not found: "+l+" . Object:"),void console.log(t);n=e.outerHTML}else n=Utils.newNode(Object.keys(l)[0]).outerHTML}else if("SELECT"===e.tagName||"DATALIST"===e.tagName)n="<option>","string"==typeof l&&(l={text:l,value:l});else if("UL"===e.tagName||"OL"===e.tagName)n="<li>";else{if("NAV"!==e.tagName)return console.log("Warning: No template found for object:"),console.log(e),void console.log(t);n="<a>"}const a=Utils.htmlNode(n);a.setAttribute("data-id",s),e.append(a),o._setValues(a,l)}}_getTemplate(e,t){const i=this;if(void 0!==t._template&&""!==t._template)return t._template;{let o;if(void 0!==t.template?Utils.isPlainObject(t.template)?(o=Utils.newNode("div"),i._setValues(o,t.template)):o=Utils.isSelectorID(t.template)?document.querySelector(t.template):Utils.isHtml(t.template)?Utils.htmlNode("<template>"+t.template+"</template>"):Utils.htmlNode("<template>"+Utils.newNode(t.template).outerHTML+"</template>"):o=Utils.node("template",e),o){const e=o.innerHTML.trim();return i._defineProp(t,"_template",e),e}return e.innerHTML.trim()}}_setValues(e,t){const i=this;if(Utils.isArray(t)&&(t={items:t}),Utils.isPlainObject(t)){i._setNode(e,t),t.hasOwnProperty("html")&&null!==t.html&&i._setValue(e,"html",t.html),t.hasOwnProperty("template")?t.hasOwnProperty("items")||(t.items=[]):t.hasOwnProperty("items")&&console.log("Warning: 'items' specified but no template found.");for(let o in t){const n=t[o];if("html"===o||"template"===o||o.startsWith("_"));else if("items"===o)i._doArray(e,t,n);else if("items"!==o||Utils.isArray(n)||(console.log("Warning: 'items' specified but value is not and array in element: "),console.log(e),console.log("Passed values are: "),console.log(n)),void 0!==M2D2._ext[o]&&Utils.isFunction(M2D2._ext[o])){const t=M2D2._ext[o](n,e);t&&i._setValues(e,t)}else if("#"===o[0])i._doRender(Utils.node(o),n);else if(Utils.isArray(n)&&2===n.length&&void 0!==n[0]._node){let t=n[0]._update||null;void 0===e._orig_update&&(e._orig_update=t,n[0]._update=function(){i._data[o]=n[0][n[1]],null!==e._orig_update&&e._orig_update()}),i._setValue(e,o,n[0][n[1]])}else if("text"===o&&null!==n)i._setValue(e,o,n);else if("dataset"===o&&Utils.isPlainObject(n))for(let t in n)e.setAttribute("data-"+t,n[t]);else if("style"===o)if(Utils.isPlainObject(n))for(const t in n)e.style[t]=n[t];else e.style=n;else if(o.startsWith("on")&&Utils.isFunction(n))e[o]=n;else if(n instanceof Date)i._setValue(e,o,n);else if(!i._hasAttr(e,o)||Utils.isObject(n)||"id"===o&&Utils.isNumeric(n)){let t=Utils.node(o,e);if(!t&&(t=Utils.node("#"+o,e),t||(t=Utils.node("."+o,e)),!t&&-1!==i._htmlGenTags.indexOf(o))){const t=Utils.newNode(o);e.append(t),i._doRender(t,n);continue}t?i._doRender(t,n):console.log("No child or attribute found for: "+o)}else if("boolean"==typeof e[o]?e[o]=n:e.setAttribute(o,n),"value"===o){let t=e.onchange||null;void 0===e._orig_change&&(e._orig_change=t,e.onchange=function(){this.setAttribute(o,this.value),null!==e._orig_change&&e._orig_change()})}}}else i._setValue(e,null,t)}_setValue(e,t,i){const o=this;let n=!1;if(null==t?void 0===i||null==i?(console.log("Value was undefined in element :"),console.log(e)):Utils.isPlainObject(i)&&void 0!==i.text?i=i.text:!Utils.isNumeric(i)&&Utils.isHtml(i)&&(n=!0):"html"===t&&(n=!0),n)e.innerHTML=i;else if("value"===t||null==t&&o._hasAttr(e,"value")&&"LI"!==e.tagName)o._hasAttr(e,"checked")?!0===i||"true"===i||1===i?e.setAttribute("checked",!0):!1===i||"false"===i||0===i?e.setAttribute("checked",!1):e.value=i:i instanceof Date?e.valueAsDate=i:e.value=i;else if(e.childElementCount>0){for(let t in e.childNodes){const o=e.childNodes[t];if(3===o.nodeType)return void o.replaceWith(i)}e.innerHTML=e.innerHTML+i}else e.innerText=i}_hasAttr(e,t){let i=!1;if(e&&!Utils.isNumeric(t))switch(t){case"checked":i=void 0!==e.type&&("radio"===e.type||"checkbox"===e.type);break;default:i=void 0!==e[t]||e.hasAttribute(t)}return i}_defineProp(e,t,i){Utils.isObject(e)&&void 0===e[t]&&(Object.defineProperty(e,t,{enumerable:!1,writable:!0}),e[t]=i)}_setNode(e,t){this._defineProp(t,"_node",e),this._defineProp(e,"_m2d2",t)}_proxy(e,t){this._defineProp(e,"_proxy",!0);const i={get:function(t,o,n){if("m2d2"===o||"_"===o[0])return t[o];{const s=Reflect.get(t,o,n),l=Object.getOwnPropertyDescriptor(t,o);if(l&&!l.writable&&!l.configurable)return s;try{return Utils.isArray(e)&&!Utils.isNumeric(o)?t[o]:new Proxy(t[o],i)}catch(e){return s}}},defineProperty:function(e,i,o){return t(e,i,o),Reflect.defineProperty(e,i,o)},deleteProperty:function(e,i){return t(e,i),Reflect.deleteProperty(e,i)},set:function(e,i,o){return e[i]=o,t(e,i,{value:o}),void 0!==e._update&&e._update(),!0}};return new Proxy(e,i)}set data(e){this._data=e,this.update(this._data)}get data(){return this._data}}const m2d2=function(e,t,i){const o={},n=typeof e;switch(n){case"string":if(void 0===t)return o.data=e,null;o.root=e,Utils.isArray(t)&&(t={items:t}),o.data=t,o.template=i;break;case"object":e instanceof Node&&(o.root=e,e=t);case"function":Utils.isArray(e)&&(t={items:e}),o.data=e,o.template=i;break;default:return console.log("First argument passed to m2d2, with value: ("+e+") is of unknown type: "+n),null}return new M2D2(o).get()};
M2D2.extend({show:function(e,t){const n=function(){return getComputedStyle(t,null).display};if(e){if("none"===n())if(t.dataset._m2d2_display)t.style.display=t.dataset._m2d2_display;else if(t.style.removeProperty("display"),"none"===n()){const e=function(){const e=document.getElementsByTagName("body")[0],n=document.createElement("template"),l=document.createElement(t.tagName);n.appendChild(l),e.appendChild(n);const s=getComputedStyle(l,null).display;return n.remove(),s}();t.style.display=t.dataset.display||("none"!==e?e:"block")}}else{const e="none"!==t.style.display?t.style.display:n();"none"!==e&&(t.dataset._m2d2_display=e),t.style.display="none"}}});
M2D2.extend({color:function(s,t){t.style.color=s},bgcolor:function(s,t){t.style.backgroundColor=s},css:function(s,t){t.className=s},"-css":function(s,t){let l=Utils.isArray(s)?s:s.split(" ");for(let s in l)t.classList.remove(l[s])},"+css":function(s,t){let l=Utils.isArray(s)?s:s.split(" ");for(let s in l)t.classList.add(l[s])}});